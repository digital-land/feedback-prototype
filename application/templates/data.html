{% extends "layouts/page.html" %}
{% block pageTitle %}Feedback{% endblock %}

{% block content_primary %}

  {% macro renderURL(url) %}
    <span class="c-url c-url--scroll">{{ url }}</span>
  {% endmacro %}

  {% macro renderDataStat(data, dataset) %}
    {% set count = data | length %}
    {{ count | string }} {{ dataset }}{{"'s" if count > 1 else '' }}
  {% endmacro %}

  <h2 class="govuk-heading-l">About this source</h2>

  {{
    govukSummaryList({
      'rows': [
        {
          'key': {
            'text': "Provided by"
          },
          'value': {
            'html': organisation.name
          },
        },
        {
          'key': {
            'text': "Dataset"
          },
          'value': {
            'html': dataset.name
          },
        },
        {
          'key': {
            'text': 'This source contains'
          },
          'value': {
            'text': renderDataStat(data, dataset.name)
          },
        },
        {
          'key': {
            'text': "URL"
          },
          'value': {
            'html': renderURL(endpoint_url)
          },
        },
      ]
    })
  }}

  <h3 class="govuk-heading-m">Data sample</h3>

  <p>The following is a sample of data from this source. </p>

  {% for d in data %}
    {{
      appDataCard({
        'title': d.name,
        'data': {
          'prefix': d.prefix,
          'reference': d.reference,
          'url': 'https://www.planning.data.gov.uk/entity/'+ d.entity|string,
          'json': d.json,
          'geometry': d.geometry
        },
      })
    }}
  {% endfor %}

{% endblock %}
